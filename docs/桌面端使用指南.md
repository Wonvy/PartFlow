# 🖥️ PartFlow Desktop 桌面端使用指南

## 📖 简介

PartFlow Desktop 是基于 Electron 构建的跨平台桌面应用程序，为用户提供原生的桌面体验，支持 Windows、macOS 和 Linux 系统。

---

## ✨ 特性

### 🎯 核心功能
- ✅ **完整的零件管理**：与 Web 端功能完全一致
- ✅ **离线优先设计**：本地数据库存储，无需联网即可使用
- ✅ **系统集成**：系统托盘、原生菜单、键盘快捷键
- ✅ **窗口管理**：记住窗口大小和位置，支持最大化/最小化

### 🚀 性能优势
- **快速启动**：原生应用启动速度快
- **流畅体验**：无浏览器开销，性能更优
- **资源占用低**：优化的内存和 CPU 使用

---

## 📦 安装

### Windows

1. 下载安装包：`PartFlow Setup 0.1.0.exe`（约 77 MB）
2. 双击运行安装程序
3. 按照安装向导完成安装
4. 从开始菜单或桌面快捷方式启动应用

### macOS（即将支持）

```bash
# 下载 DMG 文件
# 拖动到应用程序文件夹
# 双击启动
```

### Linux（即将支持）

```bash
# 下载 AppImage 或 deb/rpm 包
# 给予执行权限并运行
chmod +x PartFlow-0.1.0.AppImage
./PartFlow-0.1.0.AppImage
```

---

## 🚀 快速开始

### 首次启动

1. **启动后端服务**（当前版本需要）：
   ```bash
   # 在项目目录打开终端
   pnpm --filter @partflow/server dev
   ```

2. **启动桌面应用**：
   - 双击桌面快捷方式
   - 或从开始菜单选择 PartFlow

3. **应用会显示提示**：
   - 首次启动会弹出提示框，说明需要后端服务
   - 确认后端服务运行在 `http://localhost:3333`

### 日常使用

1. **确保后端服务运行**
2. **启动 PartFlow Desktop**
3. **开始管理零件**

---

## 🎮 功能使用

### 零件管理

#### 新建零件
- 点击右上角 **`[ + ]`** 按钮
- 填写零件信息（名称、规格、分类等）
- 上传图片或使用相机拍照
- 点击保存

#### 搜索零件
- 在左侧搜索框输入关键词
- 实时显示搜索结果
- 支持名称、规格、分类、材质等多字段搜索
- 匹配的关键词会高亮显示

#### 编辑零件
- 单击零件卡片进入编辑模式
- 修改信息后保存

#### 库存调整
- 使用零件卡片上的 **`-`** 和 **`+`** 按钮快速调整
- 或直接在输入框中输入数量

### 分类管理

#### 创建分类
- 切换到 **分类** 选项卡
- 点击 **新建分类**
- 选择父分类（可选）
- 上传图标图片
- 填写分类名称和描述

#### 查看分类
- 支持三级分类结构
- 一级、二级分类显示为列表
- 三级分类显示为正方形卡片（带图标）
- 支持折叠/展开

### 盒子管理

#### 新建盒子
- 切换到 **盒子** 选项卡
- 点击 **新建盒子**
- 输入唯一的盒子编码（大写字母+数字）
- 输入盒子名称（可选）

#### 查看盒子零件
- 单击盒子卡片
- 弹出窗口显示该盒子内的所有零件

### 数据管理

#### 导出数据
- 切换到 **数据** 选项卡
- 点击 **导出 JSON**
- 选择保存位置

#### 导入数据
- 点击 **导入 JSON**
- 选择之前导出的 JSON 文件
- 确认导入

---

## ⌨️ 键盘快捷键

### 应用控制
- `Ctrl/Cmd + Q`：退出应用
- `Ctrl/Cmd + W`：关闭窗口
- `Ctrl/Cmd + M`：最小化窗口

### 编辑操作
- `Ctrl/Cmd + Z`：撤销
- `Ctrl/Cmd + Shift + Z`：重做
- `Ctrl/Cmd + X`：剪切
- `Ctrl/Cmd + C`：复制
- `Ctrl/Cmd + V`：粘贴
- `Ctrl/Cmd + A`：全选

### 视图控制
- `Ctrl/Cmd + R`：重新加载
- `Ctrl/Cmd + Shift + R`：强制重新加载
- `F11`：全屏切换
- `Ctrl/Cmd + 0`：重置缩放
- `Ctrl/Cmd + +`：放大
- `Ctrl/Cmd + -`：缩小

### 开发工具
- `Ctrl/Cmd + Shift + I`：开发者工具

---

## 🔧 系统托盘

### 功能
- **最小化到托盘**：关闭窗口时，应用不会退出，而是隐藏到系统托盘
- **托盘菜单**：
  - **显示窗口**：恢复应用窗口
  - **退出**：完全关闭应用

### 使用
1. 点击窗口关闭按钮 → 应用隐藏到托盘
2. 点击托盘图标 → 恢复窗口
3. 右键托盘图标 → 显示菜单

---

## 🛠️ 开发者模式

### 从源码运行

#### 前置条件
- Node.js 18+
- pnpm 8+

#### 步骤

1. **克隆仓库**：
   ```bash
   git clone <repository-url>
   cd PartFlow
   ```

2. **安装依赖**：
   ```bash
   pnpm install
   ```

3. **启动后端**（终端 1）：
   ```bash
   pnpm --filter @partflow/server dev
   ```

4. **启动桌面端**（终端 2）：
   ```bash
   pnpm --filter @partflow/desktop dev
   ```

5. **开发者工具**：
   - 应用启动后自动打开 DevTools
   - 热模块替换 (HMR) 自动生效

### 构建生产版本

```bash
# 进入桌面端目录
cd apps/desktop

# 构建应用
pnpm build

# 查看生成的安装包
ls release/
```

生成的文件：
- `PartFlow Setup 0.1.0.exe`（Windows 安装程序）
- `win-unpacked/`（未打包的应用文件）

---

## 🐛 常见问题

### 应用启动后窗口空白

**原因**：后端服务未启动

**解决方案**：
1. 打开终端
2. 进入项目目录
3. 运行：`pnpm --filter @partflow/server dev`
4. 确保后端运行在 `http://localhost:3333`
5. 重新启动桌面应用

### 无法保存数据

**原因**：数据库文件权限问题或后端服务未响应

**解决方案**：
1. 检查后端服务是否正常运行
2. 查看后端日志是否有错误
3. 确认数据库文件 `packages/server/data/partflow.db` 可写

### 应用启动慢

**原因**：首次启动需要初始化数据库

**解决方案**：
- 首次启动较慢是正常现象
- 后续启动会快很多
- 如果持续慢，尝试清理 `userData` 缓存

### 窗口位置不正确

**原因**：窗口状态文件损坏

**解决方案**：
1. 完全退出应用
2. 删除窗口状态文件：
   - Windows: `%APPDATA%\PartFlow\window-state.json`
   - macOS: `~/Library/Application Support/PartFlow/window-state.json`
   - Linux: `~/.config/PartFlow/window-state.json`
3. 重新启动应用

---

## 📂 文件位置

### 应用数据

| 系统 | 路径 |
|------|------|
| Windows | `%APPDATA%\PartFlow\` |
| macOS | `~/Library/Application Support/PartFlow/` |
| Linux | `~/.config/PartFlow/` |

### 数据库

**当前版本**：`packages/server/data/partflow.db`（项目目录）

**未来版本**：将迁移到用户目录

### 日志文件

**开发模式**：终端输出

**生产模式**：`<userData>/logs/`（计划中）

---

## 🔄 更新

### 当前版本
- 手动下载新版本安装包
- 运行安装程序覆盖旧版本

### 未来版本（计划）
- 应用内自动检查更新
- 一键更新到最新版本
- 增量更新减少下载量

---

## 🎯 路线图

### v0.5.0（计划中）
- [ ] 自动启动后端服务
- [ ] 数据库迁移到用户目录
- [ ] 应用自动更新功能

### v0.6.0（计划中）
- [ ] 应用内设置界面
- [ ] 自定义键盘快捷键
- [ ] 主题切换（浅色/深色）

### v0.7.0（计划中）
- [ ] 数据备份与恢复
- [ ] 云同步支持
- [ ] 多语言支持

---

## 📞 获取帮助

- **文档**：查看项目 `docs/` 目录
- **问题反馈**：提交 GitHub Issue
- **功能建议**：提交 Feature Request

---

## 📄 许可证

MIT License - 详见项目 LICENSE 文件

---

**最后更新**：2025-10-24  
**当前版本**：v0.4.0

