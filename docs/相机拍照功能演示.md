# 📷 PartFlow 相机拍照功能演示

> 版本：v0.1.2  
> 日期：2025-10-23  
> 支持平台：Web、移动端、平板

---

## 🎯 功能概览

PartFlow 新增跨平台相机拍照功能，支持：

- ✅ **Web 端**：使用电脑/平板摄像头实时拍照
- ✅ **移动端**：使用手机原生相机拍摄
- ✅ **前后切换**：灵活切换前后置摄像头
- ✅ **参考线**：辅助对齐和构图
- ✅ **高清画质**：最高 1920×1080 分辨率

---

## 💻 Web 端演示

### 1. 打开拍照界面

**路径**：零件列表 → 新建零件 → 零件图片 → "📷 使用相机拍照"

```
1. 访问 http://localhost:5173
2. 点击 "➕ 新建" 按钮
3. 滚动到 "零件图片" 部分
4. 点击绿色按钮 "📷 使用相机拍照"
```

### 2. 授权摄像头访问

**首次使用时**：
- 浏览器会弹出权限请求
- 点击"允许"授予相机访问权限
- Chrome/Edge：左上角会显示相机图标

**权限被拒绝**：
- 点击地址栏左侧的锁图标
- 找到"相机"权限
- 改为"允许"
- 刷新页面

### 3. 拍摄零件照片

**界面说明**：
```
┌─────────────────────────────┐
│  [✕ 关闭]                   │  ← 顶部工具栏
├─────────────────────────────┤
│                             │
│    ┌───────────────┐        │
│    │               │        │  ← 参考线框
│    │  放置零件     │        │
│    │               │        │
│    └───────────────┘        │
│  "📷 将零件放在框内"        │
│                             │
├─────────────────────────────┤
│  [🔄]  [📸]  [ ]            │  ← 控制栏
│  切换   拍照                │
│                             │
│  💡 保持设备稳定，确保光线充足 │
└─────────────────────────────┘
```

**操作步骤**：
1. 将零件放在虚线框内
2. 调整位置，确保零件清晰可见
3. 点击底部蓝色圆形 "📸 拍照" 按钮
4. 图片自动添加到表单
5. 继续填写其他信息并保存

**切换摄像头**：
- 点击左侧 "🔄 前置/后置" 按钮
- 默认使用后置摄像头（拍摄零件更清晰）
- 前置摄像头适合自拍或镜子辅助

### 4. 最佳实践

**光线要求**：
- ✅ 充足的自然光或室内灯光
- ✅ 正面光源（避免背光）
- ❌ 避免强烈的阴影
- ❌ 避免反光表面

**背景选择**：
- ✅ 纯色背景（白色、灰色桌面）
- ✅ 整洁无杂物
- ❌ 避免花纹背景
- ❌ 避免与零件颜色相近

**拍摄角度**：
- ✅ 正视图（俯拍）
- ✅ 45度角（立体感）
- ✅ 包含关键特征
- ❌ 避免过度倾斜

**设备稳定**：
- ✅ 将笔记本放在稳固表面
- ✅ 使用三脚架（如有）
- ✅ 双手扶稳平板
- ❌ 避免晃动

---

## 📱 移动端演示

### 1. 启动移动应用

```bash
# 开发模式
cd apps/mobile
pnpm start

# 扫描二维码在手机上打开
# 或使用 Expo Go 应用
```

### 2. 使用相机拍照

**方式 1: 直接拍照**
```
1. 打开零件表单
2. 点击 "📷 拍照" 按钮
3. 授予相机权限（首次）
4. 将零件放在参考框内
5. 点击底部圆形按钮拍照
6. 图片自动添加
```

**方式 2: 从相册选择**
```
1. 打开零件表单
2. 点击 "📁 从相册选择"
3. 授予相册权限（首次）
4. 浏览并选择图片
5. 可裁剪调整
6. 确认添加
```

### 3. 移动端界面

**全屏拍照模式**：
```
┌─────────────────────────────┐
│                    [✕ 关闭] │
│                             │
│    ┌───────────────┐        │
│    │               │        │
│    │   将零件      │        │
│    │   放在框内    │        │
│    │               │        │
│    └───────────────┘        │
│  "📷 将零件放在框内"        │
│                             │
│                             │
│                             │
│  [🔄]     [📸]             │
│  切换      拍照             │
│                             │
│  💡 保持设备稳定，确保光线充足 │
└─────────────────────────────┘
```

**操作手势**：
- 🔄 **点击左侧图标**：切换前后摄像头
- 📸 **点击中央圆形按钮**：拍照
- ✕ **点击右上角**：退出相机
- 🤏 **双指缩放**：放大/缩小（部分设备支持）

### 4. 移动端最佳实践

**持握方式**：
- ✅ 双手持握（横屏）
- ✅ 大拇指控制快门
- ✅ 手肘夹紧身体（稳定）
- ❌ 避免单手晃动

**距离调整**：
- ✅ 距离 20-50cm（小零件）
- ✅ 距离 50-100cm（大零件）
- ✅ 填满参考框 80%
- ❌ 不要太近（失焦）

**环境选择**：
- ✅ 室内明亮处
- ✅ 窗边自然光
- ✅ 台灯辅助
- ❌ 避免逆光

---

## 🎬 完整演示流程

### 场景：添加电阻零件

**步骤 1: 准备**
- 零件：碳膜电阻 1kΩ
- 背景：白色 A4 纸
- 光源：台灯 + 自然光

**步骤 2: 打开应用**
- Web端：http://localhost:5173
- 点击 "➕ 新建"

**步骤 3: 基本信息**
```
名称：碳膜电阻
规格：1kΩ ±5%
材质：碳膜
分类：电子元件 > 电阻
位置：工作台 A1 抽屉
库存：100
预警阈值：20
```

**步骤 4: 拍照**
1. 滚动到"零件图片"
2. 点击 "📷 使用相机拍照"
3. 允许相机权限
4. 将电阻放在白纸上
5. 对准参考框
6. 点击 "📸 拍照"
7. 检查图片清晰度
8. 如不满意，点击 "📷 拍照" 重拍

**步骤 5: 保存**
- 点击 "💾 保存" 按钮
- 查看零件列表
- 确认图片显示正常

---

## 🔧 故障排除

### 问题 1: 无法访问相机

**症状**：点击拍照按钮后显示错误

**解决方案**：
1. **检查权限**
   - Chrome: 地址栏 → 相机图标 → 允许
   - Firefox: 地址栏 → 🔒 → 权限 → 相机 → 允许
   - Safari: 偏好设置 → 网站 → 相机

2. **检查设备**
   - 确保电脑有摄像头
   - 检查摄像头未被其他应用占用
   - Windows: 设置 → 隐私 → 相机
   - Mac: 系统偏好设置 → 安全性与隐私 → 相机

3. **检查浏览器**
   - 使用 Chrome/Edge（推荐）
   - 更新到最新版本
   - 尝试隐私/无痕模式

### 问题 2: 画面卡顿或黑屏

**原因**：
- 摄像头被其他应用占用
- 浏览器资源不足
- 驱动程序问题

**解决方案**：
1. 关闭其他使用摄像头的应用（Zoom、Teams等）
2. 关闭浏览器其他标签页
3. 重启浏览器
4. 更新摄像头驱动程序

### 问题 3: 拍照后图片模糊

**原因**：
- 光线不足
- 摄像头分辨率低
- 晃动
- 距离不当

**解决方案**：
1. 增加光源（台灯、开窗）
2. 清洁摄像头镜头
3. 使用三脚架稳定设备
4. 调整零件与摄像头距离

### 问题 4: 移动端权限被拒绝

**iOS**：
```
1. 打开 "设置"
2. 找到 "Expo Go" 或应用名称
3. 点击 "相机" / "照片"
4. 选择 "允许"
5. 返回应用重试
```

**Android**：
```
1. 打开 "设置"
2. 应用和通知 → 应用权限
3. 找到 "Expo" 或应用名称
4. 权限 → 相机 / 存储
5. 允许
6. 返回应用重试
```

---

## 💡 高级技巧

### 技巧 1: 使用标尺对比

拍摄小零件时，在旁边放置标尺或硬币，方便识别尺寸：
```
┌──────────────────┐
│  零件    [标尺]  │  ← 标尺提供尺寸参考
│                  │
│    [螺丝]   1cm  │
│            2cm   │
└──────────────────┘
```

### 技巧 2: 多角度拍摄

重要零件可拍摄多个角度，分别创建零件记录或拼图：
- 正视图：俯拍
- 侧视图：显示高度
- 特写：显示型号标识

### 技巧 3: 批量拍摄

需要录入多个零件时：
1. 统一布置所有零件
2. 依次拍照（不关闭相机）
3. 每拍一张就填写一个零件信息
4. 流水线式高效录入

### 技巧 4: 使用手机支架

Web端使用平板或笔记本拍照时：
- 使用手机支架固定设备
- 俯拍角度（45度）
- 零件放在支架下方桌面
- 双手操作零件位置

---

## 📊 性能建议

### 图片大小

**Web 端摄像头**：
- 默认分辨率：640×480 或更高
- 压缩质量：90%
- 平均大小：100-300KB

**移动端相机**：
- 高清模式：1920×1080
- 压缩质量：80%
- 平均大小：300-800KB

### 存储考虑

当前使用内存存储（Base64），重启后丢失：
- 单张图片：100KB - 1MB
- 100个零件：10MB - 100MB
- 建议定期备份重要零件图片

未来版本（v0.2.0）将支持：
- 持久化存储
- 图片服务器
- 云端同步

---

## 🎉 总结

相机拍照功能让零件管理更加便捷：

✨ **优势**：
- 🚀 快速录入：无需导出导入
- 📱 移动友好：随时随地拍照
- 🎯 直观管理：一眼识别零件
- 🔄 灵活切换：前后摄像头自由选择

💡 **建议**：
- 📷 优先使用相机拍照
- 🖼️ 备用剪贴板粘贴
- 📁 最后选择文件上传

**立即体验，让零件管理更高效！** 📸✨

---

**相关文档**：
- 📷 [图片上传指南](./图片上传指南.md)
- 🚀 [快速开始](./快速开始.md)
- 📖 [使用指南](./使用指南.md)

